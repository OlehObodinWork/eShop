@page "/user/login"
@inject NavigationManager Nav
@attribute [Authorize]

@code {
    [SupplyParameterFromQuery]
    public string? ReturnUrl { get; set; }

    [CascadingParameter]
    public HttpContext? HttpContext { get; set; }

    protected override void  OnInitialized()
    {
        var returnUrl = new Uri(ReturnUrl ?? "", UriKind.Relative);
        Nav.NavigateTo(returnUrl.ToString(), replace: true);
    }

    public static string Url(NavigationManager nav)
        => $"user/login?returnUrl={Uri.EscapeDataString(nav.ToBaseRelativePath(nav.Uri))}";
}
